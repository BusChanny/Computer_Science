1.  Application Layer
2.  Presentation Layer
3.  Session Layer
4.  Transport Layer
5.  Network Layer
6.  Data Link Layer
7.  Physical Layer

ex. 계층명 - 사용하는 데이터 단위

### Physical Layer(물리 계층, L1) - bit

-   물리 계층은 디지털 데이터 -> 전기적 신호로 변환해 입출력을 담당하는 계층으로 전기적인 신호(비트열)를 연결된 모든 노드에게 전달.
-   단순한 전기적 신호 전달의 역할
-   연결된 모든 노드에 패당 패킷이 전송된다.

| 기능 및 특징 | 디지털 데이터를 전기적 신호로 변환해 입출력 담당. 두 장치 간 실제 접속과 절단 등 기계적, 전기적 특성에 대한 규칙 정의. |
| --- | --- |
| 장비 | 허브, 리피터, 전선, 광케이블, 무선 전파 |
| 프로토콜 | RS-232C 등 |

### Data Link Layer(데이터 링크 계층, L2) - frame

-   데이터 칭크 계층은 물리 계층에서의 있는 그대로의 데이터를 신뢰할 수 있는 링크로 변환.
-   즉, 데이터 링크 계층이 데이터가 오류나 손실없이 전송됨을 보장하기 위해 \_흐름제어, 오류제어\_등의 기능을 수행한다.
-   신뢰성 있는 프레임을 인접한 노드에게로 전송한다.
-   인접 노드간의 통신으로 목적지 노드에 도달하기 위해서 각 노그에 대한 \_물리적 주소\_를 설정한다.
-   주요 장비는 스위치, 브릿지
-   1계층의 물리적 링크인 MAX 주소를 참조해 장비간 데이터를 전송
-   전송하는 데이터(bit 모음)의 헤더에 목적지 주소를 붙이고 꼬리 부분에는 오류 검출을 위한 부분을 붙인 frame 전송
    -   물리 계층에서 발생할 수 있는 오류를 찾고 수정하는데 필요한 기능/절차들을 제공

| 기능 및 특징 | 물리 계층에서의 데이터를 신뢰할 수 있는 링크로 변환 후 인접 노드로 전송. 논리적 연결 제어를 담당하는 LLC, 장비간 물리적 접속을 담당하는 MAC 존재. _흐름제어, 오류제어, 순서제어_ |
| --- | --- |
| 장비 | 스위치(L2), 브릿지, 랜카드, 이더넷, ARP 등 |
| 프로토콜 | HDLC, LAPB, PPP, LLC 등 |

### Network Layer(네트워크 계층, L3) - packet

-   송신측에서 수신측까지 패킷을 안전하게 전달하기 위한 계층
-   종단 노드 간의 라우팅 담당 (node to node)
-   라우팅(Routing)이란 목적지까지 데이터를 전송하기 위한 최적의 경로를 설정하고 패킷을 교환하는 것.
-   최종 목적지 노드까지 가기 위해선 노드에 대한 논리적 주소(IP 주소)가 필요.

_데이터 링크 : 같은 네트워크(링크) 상에서 패킷의 전달_  
_네트워크: 최종 목적지까지의 패킷 전달_

| 기능 및 특징 | 종단 노드간의 라우팅 담당. 최종 목적지 노드 식별을 위해 IP 주소 사용. 네트워크 연결을 설정/유지/해제, 라우팅, 패킷 정보 전송 |
| --- | --- |
| 장비 | 라우터, 스위치(L3) |
| 프로토콜 | IP, ARP, RARP, ICMP, IGMP 등 |

## Transport Layer(전송계층, L4) - segment

-   세션을 맺고 있는 두 사용자 사이의 신뢰성 있는 데이터 전송을 위한 종단간의 전송 담당. (process to process)
-   종단간의 전송: 송신 컴퓨터의 응용프로그램(프로세스)에서 수신 컴퓨터의 응용프로그램으로의 전달.
-   목적지 프로세스를 찾아가기 위해서 프로세스를 식별하기 위한 논리적 주소 Port Address 사용.
-   연결제어, 오류제어, 흐름제어, 혼잡제어
    
    | 기능 및 특징 | 신뢰성있는 종단간 전송. 하위 3계층과 상위 3계층의 인터페이스 담당. 오류제어, 흐름제어 |
    | --- | --- |
    | 장비 | 게이트웨이(GateWay) |
    | 프로토콜 | TCP, UDP 등 |
    

### Session Layer(세션 계층, L5) - message

-   어플리케이션 간의 논리적 연결인 세션의 생성, 관리, 종료를 담당하는 계층.
-   대화제어를 담당
-   송수신간의 대화 동기를 해 전송하는 정보의 일부분에 동기점을 두어 수신 상태를 체크
-   인증에 따른 권한을 부여한다.
-   TLS, SSH

### Presentation Layer(표현 계층, L6)

-   송수신자가 공통으로 이해할 수 있도록 데이터 표현방식을 변경,
-   표현 방신 변경: 인코딩, 디코딩, 암호화, 복호화 등의 기능 담당
-   코드변환, 데이터암복호화, 압축, 구문검색, 문맥관리, 형식 변환 등의 기능 수행

### Application Layer(어플리케이션(응용) 계층, L7)

-   사용자가 네트워크에 접근할 수 있도록 인터페이스를 담당하는 계층

## 데이터의 구성

![데이터구성](https://user-images.githubusercontent.com/60870438/163715115-80636ac1-53f3-43b5-bcba-4300487d618e.png)

참고: [OSI 7계층 정리](https://liveyourit.tistory.com/186)

## TCP 3-way handshake

-   TCP는 장치들 사이에 논리적인 접속을 성립하기 위해 three-way handshake를 사용한다.
-   TCP/IP 프로토콜을 이용해서 통신을 하는 응용프로그램이 데이터를 전송하기 전에 정확한 전송을 보장하기 위해 상대방 컴퓨터와 사전에 세션을 수립하는 과정을 의미한다.

1.  Client -> Server: SYN 패킷 발송 후 응답 기다림
2.  Server -> Client: 요청을 수락하는 ACK와 SYN flag 설정된 패킷을 발송 후 응답 기다림
3.  Client -> Server: ACK를 보내고 Server의 상태가 Established 되면 연결이 이뤄진다.

-   이는 TCP 접속을 하기위한 필수 절차
-   SYN: synchronize sequence numbers (순차 일련 번호)
-   ACK: acknowledgement

#### 역할

-   양쪽 모두 데이터를 전송할 준비가 된 것을 보장하고, 실제 전달 시작 전 다른 쪽의 정보를 알 수 있다.
-   양쪽 모두 상대편에 대한 초기 순차 일련번호를 얻을 수 있도록 한다.
-   응용 프로그램이 데이터 전송하기 전에 먼저 정확한 전송을 보장하기 위해 사전에 세션을 수립하는 과정.

![3way](https://user-images.githubusercontent.com/60870438/163702441-0d4bbd9a-1876-4e5a-9528-7fde7f8f502a.png)

### 과정

1.  클라이언트는 서버에 접속을 요청하는 SYN 패킹을 보냄
    -   이때 클라이언트는 SYN/ACK 응답을 기다리는 SYN\_SENT 상태로 기다림
2.  서버는 SYN 요청을 받고 클라이언트에게 요청을 수락하는 ACK와 SYN flag가 설정된 패킷을 발송
    -   해당 클라이언트가 ACK를 응답하기를 기다림. 서버는 SYN\_RECEIVED 상태
3.  클라이언트는 서버에 ACK를 보내고 이후부터는 연결이 이루어지고 데이터가 이동한다.
    -   이때 서버의 상태는 ESTABLISHED
    -   이는 신뢰성 있는 연결을 제공한다.

## TCP 4-way handshake

-   3-way는 TCP의 연결을 초기화 할 때 사용하고, 4-way는 세션을 종료하기 위해 수행한다.

![4way](https://user-images.githubusercontent.com/60870438/163702439-7c9e325a-e1d8-4993-8b13-493d0a7d40da.png)

### 과정

1.  클라이언트가 연결을 종료하겠다는 FIN flag를 서버에 전송
2.  서버는 일단 확인(ACK) 메시지를 보내고 자신의 통신이 끝날 때까지 기다린다.
    -   이때 클라이언트는 서버의 통신이 끝나기를 기다리는 TIME\_WAIT 상태
3.  서버가 통신이 끝났으면 연결이 종료되었다고 클라이언트에게 FIN flag 전송
4.  클라이언트는 확인 ACK 메시지 전송

-   TIME\_WAIT: 만약, FIN flag 전송 전에 패킷이 라우팅 지연, 패킷 유실로 인한 재전송 등으로 FIN flag 보다 늦게 도착하는 경우, 데이터 유실이 발생할 수 있다. 이를 대비해 클라이언트는 서버로 부터 FIN flag를 받더라도 일정시간 동안 세션을 남겨두고 패킷을 기다린다.

참고: [TCP-HandShake](https://mindnet.tistory.com/entry/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0-22%ED%8E%B8-TCP-3-WayHandshake-4-WayHandshake)
